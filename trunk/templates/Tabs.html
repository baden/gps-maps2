{% extends "nbase.html" %}

{% block head %}
<script src='/_ah/channel/jsapi'></script>
<style type="text/css">
    /*#draggable { width: 100px; height: 70px; background: silver; }*/
	body {
		padding: 0 0 0 0;
		margin: 0 0 0 0;
		height: 100%;
		overflow: hidden;
		overflow-x: hidden;
		overflow-y: hidden;
		background-color: black;
	}
	#tabs {
		width: 100%;
		height: 100%;
		position: absolute;
		display: block;
		padding: 0 0 0 0;
		margin: 0 -10px 0 -2px;
		left: 0px;
		top: -2px;
		/*background-color: lime;*/
	}

	.ui-tabs-panel {
		display:block !important; /* set up as a block */
		position:relative; /* needed for footer positioning*/
		background-color: yellow !important;

		height:auto !important; /* real browsers */
		height:80%; /* IE6: treaded as min-height*/

		min-height:80%; /* real browsers */

		/*margin-top: 10px;
		min-height: 80%;
		height: auto;*/
		border: 2px solid black !important;
		margin-top: -100px !important;
		top: 100px;
		margin-bottom: 100px !important;
	}

</style>
{% endblock %}

{% block javainit %}
	$("#tabs").tabs({effect: 'ajax', cache: true });

	$("#draggable").draggable();
{% endblock %}


{% block body %}

<!-- tabs -->
<!--div-->
<div id="tabs">
  <ul>
    <li><a href="/s/TabMain">Главная</a></li>
    <li><a href="/s/TabMap">Карта</a></li>
    <li><a href="/s/TabLogs">Отчеты</a></li>
    <li><a href="/s/TabConfig">Настройка</a></li>
    <li><a href="/s/TabHelp">Помощь</a></li>
  </ul>

  <div style="position: absolute; bottom: 0px;background-color: red;">Сообщение из канала:<div id="channel_msg" style="display:inline; border:1px solid blue;">EMPTY</div></div>
</div>

<!--/div-->



<script>
// What is $(document).ready ? See: http://flowplayer.org/tools/documentation/basics.html#document_ready
$(document).ready(function() {

	var connected = false;
	
	sendMessage = function(path, opt_param) {
	  path += '?g=' + state.game_key;
	  if (opt_param) {
	    path += '&' + opt_param;
	  }
	  var xhr = new XMLHttpRequest();
	  xhr.open('POST', path, true);
	  xhr.send();
	};

	onOpened = function() {
		console.log("goog.appengine.Channel: onOpened ({{ token }})");
		connected = true;
		//sendMessage('opened');
		//updateBoard();
	};

	onMessage = function(m) {
		console.log("goog.appengine.Channel: onMessage");
		connected = true;
		newState = JSON.parse(m.data);
		console.log("goog.appengine.Channel message: " + newState.text);
		$("#channel_msg").html(newState.text || "error message");
	}

	onError = function() {
		console.log("goog.appengine.Channel: onError");
	}

	onClose = function() {
		console.log("goog.appengine.Channel: onClose");
		connected = false;
	}

	/*
	channel = new goog.appengine.Channel('{{ token }}');
	socket = channel.open();
	socket.onopen = onOpened;
	socket.onmessage = onMessage;
	socket.onerror = onError;
	socket.onclose = onClose;
	*/

});
</script>


{% endblock %}
